<!DOCTYPE html>
<html lang="zh">

	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>学习CodeMirror</title>

		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>

		<link href="./static/codemirror/lib/codemirror.css" rel="stylesheet">
		<script src="./static/codemirror/lib/codemirror.js"></script>

		<!--同时加载你所需要使用的脚本JS及风格样式CSS文件，如下举例：-->
		<!--编辑器风格样式-->
		<link href="./static/codemirror/theme/3024-day.css" rel="stylesheet">
		<link href="./static/codemirror/theme/3024-night.css" rel="stylesheet">
		<link href="./static/codemirror/theme/abcdef.css" rel="stylesheet">
		<link href="./static/codemirror/theme/ambiance-mobile.css" rel="stylesheet">
		<link href="./static/codemirror/theme/ambiance.css" rel="stylesheet">
		<link href="./static/codemirror/theme/ayu-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/ayu-mirage.css" rel="stylesheet">
		<link href="./static/codemirror/theme/base16-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/base16-light.css" rel="stylesheet">
		<link href="./static/codemirror/theme/bespin.css" rel="stylesheet">
		<link href="./static/codemirror/theme/blackboard.css" rel="stylesheet">
		<link href="./static/codemirror/theme/cobalt.css" rel="stylesheet">
		<link href="./static/codemirror/theme/colorforth.css" rel="stylesheet">
		<link href="./static/codemirror/theme/darcula.css" rel="stylesheet">
		<link href="./static/codemirror/theme/dracula.css" rel="stylesheet">
		<link href="./static/codemirror/theme/duotone-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/duotone-light.css" rel="stylesheet">
		<link href="./static/codemirror/theme/eclipse.css" rel="stylesheet">
		<link href="./static/codemirror/theme/elegant.css" rel="stylesheet">
		<link href="./static/codemirror/theme/erlang-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/gruvbox-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/hopscotch.css" rel="stylesheet">
		<link href="./static/codemirror/theme/icecoder.css" rel="stylesheet">
		<link href="./static/codemirror/theme/idea.css" rel="stylesheet">
		<link href="./static/codemirror/theme/isotope.css" rel="stylesheet">
		<link href="./static/codemirror/theme/lesser-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/liquibyte.css" rel="stylesheet">
		<link href="./static/codemirror/theme/lucario.css" rel="stylesheet">
		<link href="./static/codemirror/theme/material-darker.css" rel="stylesheet">
		<link href="./static/codemirror/theme/material-ocean.css" rel="stylesheet">
		<link href="./static/codemirror/theme/material-palenight.css" rel="stylesheet">
		<link href="./static/codemirror/theme/material.css" rel="stylesheet">
		<link href="./static/codemirror/theme/mbo.css" rel="stylesheet">
		<link href="./static/codemirror/theme/mdn-like.css" rel="stylesheet">
		<link href="./static/codemirror/theme/midnight.css" rel="stylesheet">
		<link href="./static/codemirror/theme/monokai.css" rel="stylesheet">
		<link href="./static/codemirror/theme/moxer.css" rel="stylesheet">
		<link href="./static/codemirror/theme/neat.css" rel="stylesheet">
		<link href="./static/codemirror/theme/neo.css" rel="stylesheet">
		<link href="./static/codemirror/theme/night.css" rel="stylesheet">
		<link href="./static/codemirror/theme/nord.css" rel="stylesheet">
		<link href="./static/codemirror/theme/oceanic-next.css" rel="stylesheet">
		<link href="./static/codemirror/theme/panda-syntax.css" rel="stylesheet">
		<link href="./static/codemirror/theme/paraiso-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/paraiso-light.css" rel="stylesheet">
		<link href="./static/codemirror/theme/pastel-on-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/railscasts.css" rel="stylesheet">
		<link href="./static/codemirror/theme/rubyblue.css" rel="stylesheet">
		<link href="./static/codemirror/theme/seti.css" rel="stylesheet">
		<link href="./static/codemirror/theme/shadowfox.css" rel="stylesheet">
		<link href="./static/codemirror/theme/solarized.css" rel="stylesheet">
		<link href="./static/codemirror/theme/ssms.css" rel="stylesheet">
		<link href="./static/codemirror/theme/the-matrix.css" rel="stylesheet">
		<link href="./static/codemirror/theme/tomorrow-night-bright.css" rel="stylesheet">
		<link href="./static/codemirror/theme/tomorrow-night-eighties.css" rel="stylesheet">
		<link href="./static/codemirror/theme/ttcn.css" rel="stylesheet">
		<link href="./static/codemirror/theme/twilight.css" rel="stylesheet">
		<link href="./static/codemirror/theme/vibrant-ink.css" rel="stylesheet">
		<link href="./static/codemirror/theme/xq-dark.css" rel="stylesheet">
		<link href="./static/codemirror/theme/xq-light.css" rel="stylesheet">
		<link href="./static/codemirror/theme/yeti.css" rel="stylesheet">
		<link href="./static/codemirror/theme/yonce.css" rel="stylesheet">
		<link href="./static/codemirror/theme/zenburn.css" rel="stylesheet">

		<!--编辑文本格式-->
		<!--<script src="./static/codemirror/mode/shell/shell.js"></script>-->
		<script src="./static/codemirror/mode/javascript/javascript.js"></script>
		<script src="./static/codemirror/mode/perl/perl.js"></script>
		<script src="./static/codemirror/mode/python/python.js"></script>
		<script src="./static/codemirror/mode/markdown/markdown.js"></script>

		<style type="text/css">
			@font-face{
				/*font-properties*/
				font-family:Consolas;
				src:url('./static/font/consola.ttf'),
				url('./static/font/consola.ttf');/*IE9*/
			}
			* {
				padding: 0;
				margin: 0;
			}
			
			.hide {
				display: none;
			}
			.CodeMirror-sizer{
				font-family: 'Consolas';
				font-size: 14px;
				
			}
		</style>

	</head>

	<body>
		<!--选择脚本编码代码-->
		<div class="controls">
			<input class="ck-code" type="radio" name="script_once_type" id="script_once_type1" checked> javascript
			<input class="ck-code" type="radio" name="script_once_type" id="script_once_type2"> markdown
			<input class="ck-code" type="radio" name="script_once_type" id="script_once_type3"> python
		</div>

		<!--选择脚本风格代码-->
		<div class="controls">
			<select id='select'>
				<option>3024-day</option>
				<option>3024-night</option>
				<option>abcdef</option>
				<option>ambiance-mobile</option>
				<option>ambiance</option>
				<option>ayu-dark</option>
				<option>ayu-mirage</option>
				<option>base16-dark</option>
				<option>base16-light</option>
				<option>bespin</option>
				<option>blackboard</option>
				<option>cobalt</option>
				<option>colorforth</option>
				<option>darcula</option>
				<option>dracula</option>
				<option>duotone-dark</option>
				<option>duotone-light</option>
				<option>eclipse</option>
				<option>elegant</option>
				<option>erlang-dark</option>
				<option>gruvbox-dark</option>
				<option>hopscotch</option>
				<option>icecoder</option>
				<option>idea</option>
				<option>isotope</option>
				<option>lesser-dark</option>
				<option>liquibyte</option>
				<option>lucario</option>
				<option>material-darker</option>
				<option>material-ocean</option>
				<option>material-palenight</option>
				<option>material</option>
				<option>mbo</option>
				<option>mdn-like</option>
				<option>midnight</option>
				<option selected>monokai</option>
				<option>moxer</option>
				<option>neat</option>
				<option>neo</option>
				<option>night</option>
				<option>nord</option>
				<option>oceanic-next</option>
				<option>panda-syntax</option>
				<option>paraiso-dark</option>
				<option>paraiso-light</option>
				<option>pastel-on-dark</option>
				<option>railscasts</option>
				<option>rubyblue</option>
				<option>seti</option>
				<option>shadowfox</option>
				<option>solarized</option>
				<option>ssms</option>
				<option>the-matrix</option>
				<option>tomorrow-night-bright</option>
				<option>tomorrow-night-eighties</option>
				<option>ttcn</option>
				<option>twilight</option>
				<option>vibrant-ink</option>
				<option>xq-dark</option>
				<option>xq-light</option>
				<option>yeti</option>
				<option>yonce</option>
				<option>zenburn</option>
			</select>
		</div>

		<!--textarea-->
		<textarea id="script_once_code">
import renderAbc from 'abcjs/src/api/abc_tunebook_svg';
import extensionSvc from '../services/extensionSvc';
  // elt：放置音乐代码段的div
  // 获取代码段文本
  // 创建新的div，用于存储乐谱图样
  // 为div配置class
  // 用图谱存储的div替换存储代码段的div
  // 执行renderAbc

const render = (elt) => {
  const content = elt.textContent;
  // Create a div element
  const divElt = document.createElement('div');
  divElt.className = 'abc-notation-block';
  // Replace the pre element with the div
  elt.parentNode.parentNode.replaceChild(divElt, elt.parentNode);
  renderAbc(divElt, content, {});
};

extensionSvc.onGetOptions((options, properties) => {
  options.abc = properties.extensions.abc.enabled;
});

extensionSvc.onSectionPreview((elt) => {
  elt.querySelectorAll('.prism.language-abc')
    .cl_each(notationElt => render(notationElt));
});
</textarea>
		<textarea id="code2" class="hide">
#!/usr/bin/env python
# -*- coding: utf8 -*-
</textarea>

		<script type="text/javascript">
			var editor = CodeMirror.fromTextArea($("#script_once_code")[0], { //script_once_code为你的textarea的ID号
				lineNumbers: true, //是否显示行号
				mode: "javascript",
				　 //默认脚本编码
				lineWrapping: true, //是否强制换行
			});

			//选择界面风格JS
			var theme = $('#select').val();
			editor.setOption("theme", theme); //editor.setOption()为codeMirror提供的设置风格的方法
			$('#select').change(function() {
				var theme = $('#select').val();
				editor.setOption("theme", theme); //editor.setOption()为codeMirror提供的设置风格的方法
			});

			//选择脚本类型JS
			var txt1 = $("#script_once_code").val();
			var txt2 = '';
			var txt3 = $("#code2").val();

			$(".ck-code").click(function() {
				var txt = editor.getValue(); //editor.getValue()获取textarea中的值
				var lang = $(this).prop("id");
				if(lang == "script_once_type1") {
					editor.setOption("mode", "javascript"); //editor.setOption()设置脚本类型
					editor.setValue(txt1); // editor.setValue()设置textarea中的值
				} else if(lang == "script_once_type2") {
					editor.setOption("mode", "markdown");
					editor.setValue(txt2);
				} else {
					editor.setOption("mode", "python");
					editor.setValue(txt3);

				}
			});
		</script>
	</body>

</html>